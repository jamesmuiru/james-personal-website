;/*FB_PKG_DELIM*/

__d("processTaggedIDs",["addTagsToWithTagsIDsTracker"],(function(a,b,c,d,e,f,g){"use strict";function a(a,b){var d=new Map(b),e=[];a==null?void 0:a.forEach(function(a){var b=[],f=a.data.id;if(f!=null){a=Array.isArray(a.data.tags)?a.data.tags:[];a.forEach(function(a){var c;if(a!=null&&(a==null?void 0:a.taggee)!=null&&typeof (a==null?void 0:(c=a.taggee)==null?void 0:c.id)==="string"){c=a.taggee.id;a.taggee.taggee_type==="PRODUCT_ITEM"?e.push(c):b.push(c)}});d=c("addTagsToWithTagsIDsTracker")(f,b,d)}});return{taggedProductIDs:e,withTagIDsTracker:d}}g["default"]=a}),98);
__d("reformCometComposerFunFacts_story.graphql",[],(function(a,b,c,d,e,f){"use strict";a={kind:"InlineDataFragment",name:"reformCometComposerFunFacts_story"};e.exports=a}),null);
__d("reformCometComposerMediaAttachmentFromStoryAttachment_attachment.graphql",[],(function(a,b,c,d,e,f){"use strict";a={kind:"InlineDataFragment",name:"reformCometComposerMediaAttachmentFromStoryAttachment_attachment"};e.exports=a}),null);
__d("reformTextWithEntities_textWithEntities.graphql",[],(function(a,b,c,d,e,f){"use strict";a={kind:"InlineDataFragment",name:"reformTextWithEntities_textWithEntities"};e.exports=a}),null);
__d("reformTextWithEntities",["CometRelay","reformTextWithEntities_textWithEntities.graphql"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){a=d("CometRelay").readInlineData(h!==void 0?h:h=b("reformTextWithEntities_textWithEntities.graphql"),a);if(a==null)return null;else{var c=a.text;a=(a=a==null?void 0:a.ranges)!=null?a:[];var e=[];for(var f=0;f<a.length;f++){var g=a[f];g!=null&&g.offset!=null&&g.length!=null&&g.entity!=null&&g.entity.__typename!=null&&g.entity.__typename!=="%other"&&g.entity.id!=null&&e.push({entity:{id:g.entity.id},length:g.length,offset:g.offset})}return{ranges:e,text:(g=c)!=null?g:""}}}g["default"]=a}),98);
__d("reformVideoProductTags_data.graphql",[],(function(a,b,c,d,e,f){"use strict";a={kind:"InlineDataFragment",name:"reformVideoProductTags_data"};e.exports=a}),null);
__d("reformVideoProductTags",["CometRelay","recoverableViolation","reformVideoProductTags_data.graphql"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){a=d("CometRelay").readInlineData(h!==void 0?h:h=b("reformVideoProductTags_data.graphql"),a);if(a==null)return null;a=a.video_product_tags;return a?a.map(function(a){var b=null;if(a==null?void 0:a.product_item){var d;a.time_ranges!=null&&a.time_ranges.length>0&&(b=a.time_ranges.map(function(a){return{end:Number(a.upper_bound),start:Number(a.lower_bound)}}));return{id:(d=a==null?void 0:(d=a.product_item)==null?void 0:d.id)!=null?d:"",image_uri:(d=a==null?void 0:(d=a.product_item)==null?void 0:(d=d.profile_picture)==null?void 0:d.uri)!=null?d:"",metadata:{time_ranges:b},name:(b=(d=a.product_item)==null?void 0:d.name)!=null?b:"",product_per_unit_price:(d=(d=a.product_item)==null?void 0:(b=d.per_unit_price)==null?void 0:b.formatted_text)!=null?d:"",product_price:(a=(b=a.product_item)==null?void 0:(d=b.listing_price)==null?void 0:d.formatted_amount)!=null?a:"",taggee_type:"PRODUCT_ITEM"}}else{c("recoverableViolation")("Product tags for comet videos are ill-formed.","comet_composer");return}}).filter(Boolean):[]}g["default"]=a}),98);
__d("transformStoryAttachmentToCometComposerEditorStateAttachment_attachment.graphql",[],(function(a,b,c,d,e,f){"use strict";a={kind:"InlineDataFragment",name:"transformStoryAttachmentToCometComposerEditorStateAttachment_attachment"};e.exports=a}),null);
__d("transformStoryAttachmentToCometComposerEditorStateAttachment",["CometRelay","recoverableViolation","reformTextWithEntities","reformVideoProductTags","transformStoryAttachmentToCometComposerEditorStateAttachment_attachment.graphql"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,e,f){var g,i,j,k,l,m,n,o,p,q;f=(f=f)!=null?f:{};f=f.reformCaption;f=f===void 0?!0:f;a=d("CometRelay").readInlineData(h!==void 0?h:h=b("transformStoryAttachmentToCometComposerEditorStateAttachment_attachment.graphql"),a);g=(g=a==null?void 0:a.style_list)!=null?g:[];var r=a==null?void 0:(i=a.target)==null?void 0:i.id;i=a==null?void 0:(i=a.target)==null?void 0:(i=i.image)==null?void 0:i.uri;j=c("reformTextWithEntities")(a==null?void 0:(j=a.target)==null?void 0:j.message);k=a==null?void 0:(k=a.target)==null?void 0:(k=k.video_title)==null?void 0:k.text;l=a==null?void 0:(l=a.target)==null?void 0:l.playable_url;m=a==null?void 0:(m=a.target)==null?void 0:m.free_form_tags;n=(n=a==null?void 0:(n=a.target)==null?void 0:n.content_tags)!=null?n:[];o=(o=a==null?void 0:(o=a.target)==null?void 0:o.video_collaborator)!=null?o:a==null?void 0:(o=a.target)==null?void 0:o.video_collaborator_invitee;p=a==null?void 0:(p=a.target)==null?void 0:p.accessibility_caption;m=m?m.map(function(a){if(a!=null)return{id:a,label:a};else{c("recoverableViolation")("Content tags for comet videos are ill-formed.","comet_composer");return}}).filter(Boolean):[];n=n?n.map(function(a){if(a.id!=null&&a.label!=null)return{id:a.id,label:a.label};else{c("recoverableViolation")("Content tags for comet videos are ill-formed.","comet_composer");return}}).filter(Boolean):[];o=o&&o.id!=null?[{id:o.id,isCollaboratorTag:!0,label:(q=o.name)!=null?q:"",photo:(q=o.profile_picture)==null?void 0:q.uri}]:[];n=(m=m==null?void 0:(q=m.concat(n))==null?void 0:q.concat(o))!=null?m:null;if(r==null||i==null)return null;var s=[];m=(m=a==null?void 0:(q=a.target)==null?void 0:(o=q.tags)==null?void 0:o.edges)!=null?m:a==null?void 0:(q=a.target)==null?void 0:(o=q.video_tags)==null?void 0:o.edges;m!=null&&m.forEach(function(a){var b;if(((b=a.tag)==null?void 0:b.is_product_tag)===!1){s.push({taggee:{id:(b=(b=a.node)==null?void 0:b.id)!=null?b:"",name:(b=a.node)==null?void 0:b.name},x:typeof ((b=a.tag)==null?void 0:(b=b.location)==null?void 0:b.x)==="number"?((b=a.tag)==null?void 0:(b=b.location)==null?void 0:b.x)*100:0,y:typeof ((b=a.tag)==null?void 0:(b=b.location)==null?void 0:b.y)==="number"?((b=a.tag)==null?void 0:(a=b.location)==null?void 0:a.y)*100:0})}});q=e.map(function(a){if(a.photo_id===r){var b;return{taggee:{id:(b=a.product_id)!=null?b:"",image_uri:(b=a.image_uri)!=null?b:"",name:(b=a.product_name)!=null?b:"",product_price:(b=a.product_price)!=null?b:"",taggee_type:"PRODUCT_ITEM"},x:(b=a.x)!=null?b:0,y:(b=a.y)!=null?b:0}}}).concat(s).filter(Boolean);o=g.includes("photo")?"PHOTO":g.includes("video")?"VIDEO":"UNKNOWN";switch(o){case"PHOTO":m={custom_accessibility_caption:p,id:r,tags:q};f===!0&&(m=babelHelpers["extends"]({},m,{message:j}));return{data:m,entID:r,fileType:"PHOTO",height:(a==null?void 0:(e=a.target)==null?void 0:(g=e.image)==null?void 0:g.height)||void 0,state:"PREEXISTING",url:i,useCDNPreview:!0,width:(a==null?void 0:(o=a.target)==null?void 0:(p=o.image)==null?void 0:p.width)||void 0};case"VIDEO":q={id:r,title:k};f===!0&&(q=babelHelpers["extends"]({},q,{message:j}));m=c("reformVideoProductTags")(a==null?void 0:a.target);return{data:babelHelpers["extends"]({},q,{additional_video_metadata:{videoProductTags:m,videoTags:n}}),entID:r,fileObjectURL:l,fileType:"VIDEO",height:(a==null?void 0:(e=a.target)==null?void 0:e.height)||void 0,imageURL:i,state:"PREEXISTING",useCDNPreview:!0,width:(a==null?void 0:(g=a.target)==null?void 0:g.width)||void 0};default:return{data:{id:r,message:j},fileType:"UNKNOWN",state:"PREEXISTING",url:i}}}g["default"]=a}),98);
__d("reformCometComposerMediaAttachmentFromStoryAttachment",["CometRelay","Promise","gkx","processTaggedIDs","reformCometComposerMediaAttachmentFromStoryAttachment_attachment.graphql","transformStoryAttachmentToCometComposerEditorStateAttachment"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function a(a,e,f,g){var i;a=d("CometRelay").readInlineData(h!==void 0?h:h=b("reformCometComposerMediaAttachmentFromStoryAttachment_attachment.graphql"),a);if(a==null)return e;i=(i=a==null?void 0:a.style_list)!=null?i:[];var k=i.includes("photo"),l=i.includes("video");if(k||l){l=c("transformStoryAttachmentToCometComposerEditorStateAttachment")(a,(k=f)!=null?k:[],{reformCaption:!1});k=l!=null?[l]:null;l=c("processTaggedIDs")(k,(l=e.withTagIDsTracker)!=null?l:new Map());var m=l.taggedProductIDs;l=l.withTagIDsTracker;g=c("gkx")("22891")&&g===!0;return babelHelpers["extends"]({},e,{attachmentArea:{activeAttachmentType:"MEDIA"},isMediaAttachmentsRequired:(e==null?void 0:e.isMediaAttachmentsRequired)===!0||g,mediaAttachments:k,mediaUploadStatuses:k!=null?j(k):void 0,taggedProductIDs:m,withTagIDsTracker:l})}g=i.includes("album");if(!g)return e;l=(m=a==null?void 0:(k=a.all_subattachments)==null?void 0:k.nodes)!=null?m:[];i=l.map(function(a){return c("transformStoryAttachmentToCometComposerEditorStateAttachment")(a,(a=f)!=null?a:[])}).filter(Boolean);a=c("processTaggedIDs")(i,(g=e.withTagIDsTracker)!=null?g:new Map());k=a.taggedProductIDs;m=a.withTagIDsTracker;return babelHelpers["extends"]({},e,{attachmentArea:{activeAttachmentType:"MEDIA"},mediaAttachments:i,mediaUploadStatuses:j(i),taggedProductIDs:k,withTagIDsTracker:m})}function j(a){return a.reduce(function(a,c){var d=c.data.id;if(d!=null&&(c.fileType==="PHOTO"||c.fileType==="VIDEO")){c=(i||(i=b("Promise"))).resolve({attachmentID:d,attachmentType:c.fileType});var e=null,f=new i(function(a){e=a});e!=null&&(a[d]={cancelUpload:function(){},onFileComplete:c,onUploadCancel:f,resolveFileUpload:function(){}})}return a},{})}g["default"]=a}),98);
__d("reformCometComposerFunFacts",["CometComposerPreAttachmentPluginTypes","CometRelay","reformCometComposerAnimatedImageFromStoryAttachment","reformCometComposerFunFacts_story.graphql","reformCometComposerMediaAttachmentFromStoryAttachment"],(function(a,b,c,d,e,f,g){"use strict";var h,i=[c("reformCometComposerAnimatedImageFromStoryAttachment"),c("reformCometComposerMediaAttachmentFromStoryAttachment")];function a(a,c){var e;a=d("CometRelay").readInlineData(h!==void 0?h:h=b("reformCometComposerFunFacts_story.graphql"),a);e=a==null?void 0:(e=a.attachments[0])==null?void 0:(e=e.style_infos[0])==null?void 0:(e=e.fun_fact_prompt)==null?void 0:e.id;if(e==null)return c;c=babelHelpers["extends"]({},c,{funFact:{promptID:e},preAttachmentArea:{activePreAttachmentType:d("CometComposerPreAttachmentPluginTypes").CometComposerPreAttachmentPluginTypes.FUN_FACT}});var f=a==null?void 0:(e=a.attachments[0])==null?void 0:e.subattachments[0];return i.reduce(function(a,b){return b(f,a)},c)}g["default"]=a}),98);
__d("reformCometComposerMediaAttachment_story.graphql",[],(function(a,b,c,d,e,f){"use strict";a={kind:"InlineDataFragment",name:"reformCometComposerMediaAttachment_story"};e.exports=a}),null);
__d("reformCometComposerMediaAttachment",["CometRelay","reformCometComposerMediaAttachmentFromStoryAttachment","reformCometComposerMediaAttachment_story.graphql"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,e){var f;a=d("CometRelay").readInlineData(h!==void 0?h:h=b("reformCometComposerMediaAttachment_story.graphql"),a);var g=a==null?void 0:a.xy_product_tags.map(function(a){return{image_uri:a==null?void 0:a.image_uri,photo_id:a==null?void 0:a.subject,product_id:a==null?void 0:a.product_id,product_name:a==null?void 0:a.name,product_price:a==null?void 0:a.price,tag_id:a==null?void 0:a.fbid,x:a==null?void 0:a.x,y:a==null?void 0:a.y}});f=(a==null?void 0:(f=a.actors[0])==null?void 0:(f=f.human_readable_type)==null?void 0:f.text)==="Page";return c("reformCometComposerMediaAttachmentFromStoryAttachment")(a==null?void 0:(a=a.attachments)==null?void 0:a[0],e,g,f)}g["default"]=a}),98);
__d("reformCometComposerMessage_story.graphql",[],(function(a,b,c,d,e,f){"use strict";a={kind:"InlineDataFragment",name:"reformCometComposerMessage_story"};e.exports=a}),null);
__d("reformCometComposerMessage",["CometRelay","cr:838","reformCometComposerMessage_story.graphql"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,c){a=d("CometRelay").readInlineData(h!==void 0?h:h=b("reformCometComposerMessage_story.graphql"),a);a=a==null?void 0:a.message;return a==null||c.formattingType!=null&&c.formattingType!=="MARKDOWN"?c:b("cr:838")(a,c)}g["default"]=a}),98);
__d("useReformCometComposerEditorState_story.graphql",[],(function(a,b,c,d,e,f){"use strict";a={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"useReformCometComposerEditorState_story",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],type:"Story",abstractKey:null};e.exports=a}),null);
__d("useReformCometComposerEditorState",["CometRelay","react","useReformCometComposerEditorState_story.graphql"],(function(a,b,c,d,e,f,g){"use strict";var h,i;c=i||d("react");c.useMemo;var j=c.c;function a(a,c){var e=j(8),f;e[0]===Symbol["for"]("react.memo_cache_sentinel")?(f=h!==void 0?h:h=b("useReformCometComposerEditorState_story.graphql"),e[0]=f):f=e[0];f=d("CometRelay").useFragment(f,a);bb0:{if(f==null||a==null){var g;e[1]===Symbol["for"]("react.memo_cache_sentinel")?(g={},e[1]=g):g=e[1];g=g;break bb0}if(e[2]!==a||e[3]!==f||e[4]!==c){var i;e[6]!==a?(i=function(b,c){return c(a,b)},e[6]=a,e[7]=i):i=e[7];i=c.reduce(i,{disableOptimisticMediaPost:!0,isEditingPreExistingStory:!0,storyID:f==null?void 0:f.id});e[2]=a;e[3]=f;e[4]=c;e[5]=i}else i=e[5];g=i}return g}g["default"]=a}),98);